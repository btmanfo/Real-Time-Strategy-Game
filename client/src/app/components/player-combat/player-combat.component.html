<div class="combat-interface">
    <div class="combat-info">
        <div class="combat-status">
            <div class="escape-attempts">Tentatives d'évasion restantes: {{ maxEscapeAttempts - combatServiceValue.escapeAttempts }}</div>
        </div>
    </div>

    <div class="players-container">
        <div class="player my-player" [ngClass]="{ 'active-turn': attacker?.name === playingServiceValue.localPlayer?.name }">
            @if (playingServiceValue.localPlayer) {
            <div class="player-role-badge">
                {{ isMyTurn() ? 'ATTAQUANT' : 'DÉFENSEUR' }}
            </div>
            }
            <img [src]="playingServiceValue.localPlayer?.avatarUrl" alt="My Avatar" class="player-avatar" />
            <h3>{{ playingServiceValue.localPlayer?.name }}</h3>
            <div class="stats">
                <div class="stat">
                    <img class="icon" src="./assets/icon/life.png" alt="Life Icon" />
                    <span>Vie: {{ (attacker?.name === playingServiceValue.localPlayer?.name ? attacker?.life : defender?.life) || 0 }}</span>
                </div>
                <div class="stat">
                    <img class="icon" src="./assets/icon/sword.png" alt="Attack Icon" />
                    <span>Attaque: {{ playingServiceValue.localPlayer?.attack }}</span>
                </div>
                <div class="stat">
                    <img class="icon" src="./assets/icon/retro-02-512.webp" alt="Defense Icon" />
                    <span>Défense: {{ playingServiceValue.localPlayer?.defense }}</span>
                </div>
            </div>
        </div>

        <div class="vs-divider">
            <div>VS</div>
        </div>

        <div class="player opponent" [ngClass]="{ 'active-turn': attacker?.name !== playingServiceValue.localPlayer?.name }">
            @if (playingServiceValue.localPlayer) {
            <div class="player-role-badge">
                {{ isMyTurn() ? 'DÉFENSEUR' : 'ATTAQUANT' }}
            </div>
            }
            <img
                [src]="attacker?.name === playingServiceValue.localPlayer?.name ? defender?.avatarUrl : attacker?.avatarUrl"
                alt="Opponent Avatar"
                class="player-avatar"
            />
            <h3>{{ attacker?.name === playingServiceValue.localPlayer?.name ? defender?.name : attacker?.name }}</h3>
            <div class="stats">
                <div class="stat">
                    <img class="icon" src="./assets/icon/life.png" alt="Life Icon" />
                    <span>Vie: {{ (attacker?.name === playingServiceValue.localPlayer?.name ? defender?.life : attacker?.life) || 0 }}</span>
                </div>
                <div class="stat">
                    <img class="icon" src="./assets/icon/sword.png" alt="Attack Icon" />
                    <span>Attaque: {{ attacker?.name === playingServiceValue.localPlayer?.name ? defender?.attack : attacker?.attack }}</span>
                </div>
                <div class="stat">
                    <img class="icon" src="./assets/icon/retro-02-512.webp" alt="Defense Icon" />
                    <span>Défense: {{ attacker?.name === playingServiceValue.localPlayer?.name ? defender?.defense : attacker?.defense }}</span>
                </div>
            </div>
        </div>
    </div>

    <div class="actions">
        <button class="attack-btn" [disabled]="attacker?.name !== playingServiceValue.localPlayer?.name" (click)="attack()">Attaquer</button>
        <button class="escape-btn" [disabled]="attacker?.name !== playingServiceValue.localPlayer?.name || isEscapeDisabled()" (click)="dodge()">
            S'évader
        </button>
    </div>
</div>
